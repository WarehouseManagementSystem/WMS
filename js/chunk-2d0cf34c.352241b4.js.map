{"version":3,"sources":["webpack:///./src/components/base/Content/TreeView/Tree/c-tree-item.vue?fea2","webpack:///src/components/base/Content/TreeView/Tree/c-tree-item.vue","webpack:///./src/components/base/Content/TreeView/Tree/c-tree-item.vue?d292","webpack:///./src/components/base/Content/TreeView/Tree/c-tree-item.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","class","objClass","attrs","on","mouseenterOnItem","mouseleaveOnItem","$event","stopPropagation","clickOnItem","dblclickOnItem","dragstart","preventDefault","dragover","dragleave","dragend","dragexit","drop","itemClass","open","icon","caretDown","caretRight","staticStyle","folderOpen","folder","fileAlt","_v","editItem","editorBlur","editValid","editInvalid","model","value","item","callback","$$v","$set","expression","_s","label","directives","name","rawName","status","children","primaryKey","selectedOption","_e","staticRenderFns","component"],"mappings":"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","file":"js/chunk-2d0cf34c.352241b4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{ref:\"dropzone\",staticClass:\"d-table-row d-flex align-items-center\",class:_vm.objClass,attrs:{\"draggable\":\"true\"},on:{\"mouseenter\":_vm.mouseenterOnItem,\"mouseleave\":_vm.mouseleaveOnItem,\"click\":function($event){$event.stopPropagation();return _vm.clickOnItem($event)},\"dblclick\":function($event){$event.stopPropagation();return _vm.dblclickOnItem($event)},\"dragstart\":_vm.dragstart,\"dragover\":function($event){$event.preventDefault();return _vm.dragover($event)},\"dragleave\":_vm.dragleave,\"dragend\":_vm.dragend,\"dragexit\":_vm.dragexit,\"drop\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.drop($event)}}},[_c('div',{staticClass:\"d-table-cell pl-1\",class:_vm.itemClass,on:{\"click\":function($event){$event.stopPropagation();_vm.open = !_vm.open}}},[(_vm.isFolder)?_c('div',[_c('i',{staticClass:\"mr-2\",class:_vm.open ? _vm.icon.caretDown : _vm.icon.caretRight,staticStyle:{\"width\":\"10px\"},on:{\"dblclick\":function($event){$event.stopPropagation();}}}),_c('i',{staticClass:\"mr-2\",class:_vm.open ? _vm.icon.folderOpen : _vm.icon.folder,on:{\"click\":function($event){$event.stopPropagation();}}})]):_c('i',{staticClass:\"mx-2\",class:_vm.icon.fileAlt})]),_vm._v(\" \"),_c('div',{staticClass:\"d-table-cell pr-1\"},[(!_vm.editItem)?_c('font',[_vm._v(_vm._s(_vm.item.label))]):_c('b-text',{ref:\"edior\",attrs:{\"size\":\"sm\",\"length\":\"30\",\"color\":\"light\",\"tempClass\":\"p-0\",\"required\":\"\"},on:{\"click\":function($event){$event.stopPropagation();},\"blur\":_vm.editorBlur,\"valid\":_vm.editValid,\"invalid\":_vm.editInvalid},model:{value:(_vm.item.label),callback:function ($$v) {_vm.$set(_vm.item, \"label\", $$v)},expression:\"item.label\"}})],1)]),_vm._v(\" \"),(_vm.isFolder)?_c('c-tree',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.open),expression:\"open\"}],staticClass:\"mx-3\",attrs:{\"status\":_vm.status,\"list\":_vm.item.children,\"primaryKey\":_vm.primaryKey},model:{value:(_vm.selectedOption),callback:function ($$v) {_vm.selectedOption=$$v},expression:\"selectedOption\"}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        <div \n            class=\"d-table-row d-flex align-items-center\" \n            :class=\"objClass\" \n            ref=\"dropzone\"\n            draggable=\"true\" \n            @mouseenter=\"mouseenterOnItem\" \n            @mouseleave=\"mouseleaveOnItem\"\n            @click.stop=\"clickOnItem\" \n            @dblclick.stop=\"dblclickOnItem\" \n            @dragstart=\"dragstart\" \n            @dragover.prevent=\"dragover\" \n            @dragleave=\"dragleave\" \n            @dragend=\"dragend\" \n            @dragexit=\"dragexit\" \n            @drop.stop.prevent=\"drop\" >\n            <div class=\"d-table-cell pl-1\" :class=\"itemClass\"  @click.stop=\"open = !open\">\n                <div v-if=\"isFolder\">\n                    <i class=\"mr-2\" :class=\"open ? icon.caretDown : icon.caretRight\" style=\"width: 10px\" @dblclick.stop />\n                    <i class=\"mr-2\" :class=\"open ? icon.folderOpen : icon.folder\"  @click.stop />\n                </div>\n                <i v-else class=\"mx-2\" :class=\"icon.fileAlt\"/>\n            </div> <!-- icon -->\n            <div class=\"d-table-cell pr-1\">\n                <font v-if=\"!editItem\">{{ item.label }}</font>\n                <b-text \n                    v-else \n                    ref=\"edior\" \n                    size='sm' \n                    length=\"30\" \n                    color=\"light\" \n                    tempClass=\"p-0\" \n                    required\n                    v-model=\"item.label\" \n                    @click.stop \n                    @blur=\"editorBlur\" \n                    @valid=\"editValid\" \n                    @invalid=\"editInvalid\" />\n            </div> <!-- label or edit -->\n        </div> <!-- item -->\n        <c-tree \n            class=\"mx-3\" \n            v-if=\"isFolder\" \n            v-show=\"open\" \n            :status=\"status\" \n            :list=\"item.children\"\n            :primaryKey=\"primaryKey\" \n            v-model=\"selectedOption\" />\n    </div>\n</template>\n\n<script>\nimport util from '@/util/index.js'\nimport config from '@/config/index.js'\nimport utilities from '@/components/utilities/index.js'\n\nimport BText from '@/components/base/Bootstrap/Form/b-text.vue'\n\n// drop\n// https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API\n// https://developer.mozilla.org/zh-CN/docs/Web/API/Document/drop_event\n\nexport default {\n    name: 'c-tree-item',\n    components: { CTree: () => import('./c-tree'), BText, },\n    data () {\n        return {\n            open: this.item.open,\n            selectedOption: this.selected,\n            hover: false,\n            editItem: false, // 编辑\n            editError: false, // 编辑错误\n            dropStatus: 'default', // 拖拽状态\n            // default: 默认, start: 开始, end: 结束, top: 上部, bottom: 下部\n        }\n    },\n    props: {\n        item: utilities.props.item,\n        status: Number,\n        primaryKey: {\n            type: String,\n            default: 'id',\n            require: true,\n        },\n        selected: Object,\n    },\n    computed: {\n        icon: function () {\n            return config.ui.icon\n        },\n        objClass: function () {\n            let isHover = this.hover ? 'bg-light text-primary font-weight-bolder' : ''\n            let beChecked = this.isSelected ? 'text-light bg-primary' : ''\n            return `${beChecked} ${isHover}`\n        },\n        itemClass: function () {\n            let beChecked = this.isSelected ? '' : 'text-secondary'\n            return `${beChecked} `\n        },\n        isFolder: function () {\n            return this.item.children\n        },\n        canEdit: function () {\n            return this.status == 1 && !this.item.disabled\n        },\n        isSelected: function () {\n            return this.selectedOption && this.item[this.primaryKey] && this.selectedOption[this.primaryKey] && this.selectedOption[this.primaryKey] == this.item[this.primaryKey]\n        },\n    },\n    methods: {\n        mouseenterOnItem: function () {\n            if (!this.isSelected) this.hover = true\n        },\n        mouseleaveOnItem: function () {\n            if (!this.isSelected) this.hover = false\n        },\n        clickOnItem: function () {\n            this.hover = false\n            this.selectedOption = this.item\n        },\n        dblclickOnItem: async function () {\n            this.hover = false\n            if (!this.canEdit) return\n            this.editItem = true\n            await this.$nextTick()\n            // 自动全选 editor 中的内容\n            await util.document.setCursorPos(this.$refs.edior.$refs.text)\n        },\n        editValid: function () {\n            this.editError = false\n        },\n        editInvalid: function () {\n            this.editError = true\n        },\n        editorBlur: function () {\n            this.hideEditor()\n        },\n        hideEditor: function () {\n            if (this.editItem && !this.editError) this.editItem = false\n        },\n        dragstart: function (event) {\n            event.target.style.opacity = '.5'\n            event.dataTransfer.setData('text/plain',null)\n            this.dropStatus = 'start'\n        },\n        dragend: function (event) {\n            event.target.style.opacity = ''\n            this.dropStatus = 'end'\n            if (this.$store.state.timer) this.$store.commit('stopTimer')\n        },\n        dragexit: function () {\n            this.dropStatus = 'end'\n            if (this.$store.state.timer) this.$store.commit('stopTimer')\n        },\n        dragover: function (event) {\n            let target = this.$refs.dropzone\n            if (this.isFolder) {\n                if (!this.$store.state.timer) {\n                    util.dom.addClass(target, 'bg-light')\n                    this.$store.commit('startTimer', {cellback: () => this.open = true, })\n                }\n            } else {\n                let currentTarget = event.currentTarget || undefined\n                if (currentTarget) this.dropStatus = event.y - currentTarget.offsetTop < currentTarget.offsetHeight / 2 ? 'top' : 'bottom'\n                util.dom.addClass(target, 'border-primary')\n                util.dom.removeClass(target, `border-top`)\n                util.dom.removeClass(target, `border-bottom`)\n                util.dom.addClass(target, `border-${this.dropStatus}`)\n            }\n        },\n        dragleave: function () {\n            let target = this.$refs.dropzone\n            util.dom.removeClass(target, 'border-primary')\n            util.dom.removeClass(target, `border-top`)\n            util.dom.removeClass(target, `border-bottom`)\n            util.dom.removeClass(target, 'bg-light')\n            if (this.isFolder && this.$store.state.timer) this.$store.commit('stopTimer')\n        },\n        drop: function (event) {\n            let target = this.$refs.dropzone\n            util.dom.removeClass(target, 'border-primary')\n            util.dom.removeClass(target, `border-top`)\n            util.dom.removeClass(target, `border-bottom`)\n            util.dom.removeClass(target, 'bg-light')\n            this.dropStatus = 'default'\n            if (this.isFolder && this.$store.state.timer) this.$store.commit('stopTimer')\n            this.$emit('item:drop', event, this.isFolder, this.dropStatus)\n        },\n    },\n    watch: {\n        selected: function (value) {\n            this.selectedOption = value\n        },\n        selectedOption: function (value) {\n            this.$emit('item:selected', value)\n        },\n    }\n}\n\n</script>","import mod from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./c-tree-item.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./c-tree-item.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./c-tree-item.vue?vue&type=template&id=21833f86&\"\nimport script from \"./c-tree-item.vue?vue&type=script&lang=js&\"\nexport * from \"./c-tree-item.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}